---
title: "Data Manipulation"
output: github_document
---

```{r}
library(tidyverse)
```

Let's import the datasets 

```{r}
litters_df = 
  read.csv("data/FAS_litters.csv", na = c("NA", ".", "") )
litters_df=
  janitor::clean_names(litters_df)

pups_df = 
  read.csv("data/FAS_pups.csv", skip = 3, na = c("NA", ".", ""))
pups_df=
  janitor::clean_names(pups_df)
```


## `select` 

`select` selects variables from my dataframe. 

select specific variables 

```{r}
select(litters_df, group, litter_number, gd0_weight)
```

Tells you to keep all of the variables from group to gd birth (selects a range)

```{r}
select(litters_df, group:gd_of_birth)
```

select by removal 

```{r}
select(litters_df, -group)
select(litters_df, -(group:gd_of_birth))
```

select by prefix 

```{r}
select(litters_df, group, starts_with("gd"))
```

rearrange by selecting

```{r}
select (litters_df, starts_with("gd"),group)
select (litters_df, litter_number, everything())

relocate(litters_df, litter_number)
```

rename by selecting 

```{r}
 select(litters_df, GROUP=group, everything())
 rename (litters_df, GROUP=group)
```

what if I only select one variable ... ? 
NOTE: almost never use the pull function; try to keep it in a dataframe 
AVOID using $ to pull as well 

```{r}
 select(litters_df, group)

 pull(litters_df, group)
```

Learning assesment: In the pups_df, select columns containing litter number sex and PD ears 

```{r}
 select (pups_df, litter_number, sex, pd_ears )
```

## `filter`

use `filer()` to filter out rows. 
This will only give us the rows with 20 in gd_of_birth column 

```{r}
 filter(litters_df, gd_of_birth == 20, pups_born_alive == 6)
```

look for more than two pups alive 

```{r}
 filter(litters_df, pups_born_alive > 5)
 filter(litters_df, pups_born_alive >= 5)
 filter(litters_df, pups_born_alive <= 5)
```

look for non matches 

```{r}
 filter (litters_df, pups_born_alive != 6)
```

match to a set / will give you every row that has con7 and con8 

```{r}
 filter(litters_df, group %in% c("Con7", "Con8"))
```

filter our missing rows with `drop_na()`. Either for entire data set or only columns you care about. 

```{r}
 drop_na(litters_df)
 drop_na(litters_df, gd0_weight)
```

learning assessment for mutate: filter to only include pups with sex 1 and only with pups with PD walk less than 11 and sex 2 

```{r}
 filter (pups_df, sex==1)
 filter (pups_df, sex == 2, pd_walk <11)
```

## `mutate` 

use `mutate` to create or modify variables 

```{r}
 mutate(
   litters_df,
   wt_gain = gd18_weight - gd0_weight,
   group = str_to_lower(group)
   )
```

## `arrange`

`arrange()` arranges things 

```{r}
 arrange(litters_df, pups_born_alive)
 arrange (litters_df, group, pups_born_alive)
 arrange(litters_df, desc(pups_born_alive))
 
 arrange(litters_df, gd0_weight)
```

## PIPES 

supposed we wanted to import, clean, select group, get rid of things with gd, get rid of anything missing variable, add weight gain variable 

Let's see a bad to way to do things 

```{r}
litters_df = 
  read_csv("data/FAS_litters.csv", na = c("NA", ".", ""))

litters_df= 
  janitor::clean_names(litters_df)

litters_df2 = 
  select(litters_df, group, litter_number, starts_with("gd"))

litters_df3= 
  drop_na(litters_df)

litters_df4=
  mutate(
    litters_df,
    wt_gain = gd18_weight - gd0_weight
  )
```

Use pipes to avoid all of this (command shift m)
I added the show_col_types / not in lecture becasue it wouldn't run the table 

```{r}
 litters_df= 
  read_csv("data/FAS_litters.csv", na = c("NA", ".", ""), show_col_types = FALSE) |> 
  janitor::clean_names() |> 
  select(group, litter_number, starts_with("gd")) |> 
  drop_na() |> 
  mutate(
    wt_gain = gd18_weight - gd0_weight)
  litters_df
```

Learning assessment: load pups data, clean the variable names, filter the data to include only pups with sex 1, remove the pd ears variablle, create a new variable that indicates whether PD pivot is 7 or more days 

```{r}
pups_df = 
    read_csv("./data/FAS_pups.csv", na = c("NA", "."), skip = 3) |>
  janitor::clean_names() |> 
  filter(sex == 1) |> 
  select(-pd_ears) |> 
  mutate(pd_pivot_gt7 = pd_pivot > 7)
pups_df
```


